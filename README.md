# ДР highload architect

## Функционал:
1. Регистрация
2. Авторизация
3. Страница с анкетой
4. Добавление (и удаление) друзей
5. Авторизация

[[Коллекция Postman с примерами запросов]](https://www.getpostman.com/collections/23e9ca62f2f24a0c5a24])

## Порядок сборки и запуска приложения
### Вариант 1. С помощью docker
#### 1. Build container
```shell
make docker
```
#### 2. Запустить приложение 
```shell
docker-compose up
```
_**Примечание:**_ в данной сборке используется в докер сеть host. При необходимости, можно поправить на Ваш тип в файлах docker-compose.yml и Dockerfile


### Вариант 2. С помощью сборки приложения
```shell
make run
```

### Конфигурирование
Конфигурирование выполняется с помощью переменных окружения

| Наименование               | Значение по умолчанию                 | Описание                                             |
|----------------------------|---------------------------------------|------------------------------------------------------|
| LISTEN_ADDRESS             | localhost:8080                        | Порт для rest сервиса                                |
| JWT_SECRET                 | superpuper                            | JWT секрет, желательно определять свой               |
| DB_DSN                     | root:pass@tcp(localhost:3306)/project | DSN подключения к БД                                 |
| DB_DSN_RO                  | -                                     | DSN только для чтения подключения к БД               |
| DB_MAX_OPEN_CONNECTIONS    | 5                                     | Количество соединений в пуле                         |
| DB_RO_MAX_OPEN_CONNECTIONS | 5                                     | Количество соединий для ro запросов                  |
| DB_RO_DISABLE              | false                                 | Принудительное отключение read only подключения к БД |
| PROMETHEUS_LISTEN          | localhost:8082                        | Порт мониторинга /metrics                            |


### Дополнительный сервис
#### Заполнение БД пользователями
```shell
make generate_users
```



